{# src/Pn/PnBundle/Resources/views/Default/index.html.twig #}

{% extends "PnPnBundle::layout.html.twig" %}

{% block title %}{{ parent() }} - Accueil{% endblock %}

{% block body %}
    <div class="maptool wrap">
        <div id="map">
            Veuillez patienter pendant le chargement de la carte...
        </div>
        <div class="searchForm">
            <form action="{{ path('pn_search') }}" method="post">
                <select class="btn" name="searchType">
                    <option value="nounou">Je cherche une nounou</option>
                    <option value="job">Je cherche un job</option>
                </select>
                <input name="field" class="search" type="search" autocomplete="true" placeholder="Indiquez votre ville ou votre code postal">
                <input type="submit" value="chercher" class="btn bg-yellow submit">
            </form>
        </div>
    </div>

    <div class="present big-wrap">
        <div class="row">
            <h3>Avec Parent Nounou, vous êtes à un clic de la famille ou de la nounou de vos rêves !</h3>
        </div>
        <div class="big-banner">
            <div class="col-md-4 topic">
                <img src="{{ asset('bundles/pnpn/images/icons/present-search.png') }}" alt="present-search">
                <h5>Des recherches efficaces</h5>
                <p>J'identifie rapidement ma nounou selon mes criteres et les recomandations</p>
            </div>
            <div class="col-md-4 topic">
                <img src="{{ asset('bundles/pnpn/images/icons/present-confiance.png') }}" alt="present-confiance">
                <h5>La confiance à l'honneur</h5>
                <p>Un système de points de confiance met en valeur les nounous expérimentées</p>
            </div>
            <div class="col-md-4 topic">
                <img src="{{ asset('bundles/pnpn/images/icons/present-badge.png') }}" alt="present-badge">
                <h5>E-formations rapides</h5>
                <p>De nombreux conseils et vidéos m'aident à mieux m'occuper des enfants.</p>
            </div>
        </div>
    </div>

    <div class="news wrap">
        <img src="{{ asset('bundles/pnpn/images/illus/parents-nounou2.png') }}" alt="enfants et nounou" style="height: 360px; margin-top: 40px;">
        {% for mooc in moocs %}
            <div class="new">
                <div class="header">
                    {% if mooc.getCategory()=='new' %}
                    <img src="{{ asset('bundles/pnpn/images/icons/alaune.png') }}" alt="a la une">
                    {% elseif mooc.getCategory()=='alimentation' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-alimentation.png') }}" alt="badge-alimentation">
                    {% elseif mooc.getCategory()=='baby' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-baby.png') }}" alt="badge-baby">
                    {% elseif mooc.getCategory()=='dialogue' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-dialogue.png') }}" alt="badge-dialogue">
                    {% elseif mooc.getCategory()=='droit' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-droit.png') }}" alt="badge-droit">
                    {% elseif mooc.getCategory()=='eveil' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-eveil.png') }}" alt="badge-eveil">
                    {% elseif mooc.getCategory()=='prevention' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-prevention.png') }}" alt="badge-prevention">
                    {% elseif mooc.getCategory()=='psycho' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-psycho.png') }}" alt="badge-psycho">
                    {% elseif mooc.getCategory()=='sante' %}
                    <img src="{{ asset('bundles/pnpn/images/badges/badge-sante.png') }}" alt="badge-sante">
                    {% endif %}
                    <div class="title">
                        <h5>{{ mooc.title }}</h5>
                    </div>
                </div>
                <div class="body">
                    <p>{{ mooc.shortPresentation(90) }}<a href="{{ path('mooc_show', {'id': mooc.id}) }}" class="blue">lire la suite</a> </p>
                </div>
            </div>
        {% endfor %}

    </div>

    <div class="mini-profiles">
        <div class="banner big-wrap">
            <h4>Dernières nounou inscrites</h4>
        </div>
        <div class="wrap">
            {% for babysitter in babysitters %}
                <a href="{{ path('babysitter_show', {'id': babysitter.babysitter.id}) }}">
                    <div class="mini-profile">
                        <div class="header">
                            {% if babysitter.babysitter.avatar %}
                                <img class="profile-picture" src="{{ asset('uploads/babysitters/' ~ babysitter.babysitter.avatar) }}" alt="photo de profil de {{ babysitter.firstname }}" style="height: 120px;">
                            {% else %}
                                <img class="profile-picture" src="{{ asset('bundles/pnpn/images/illus/nounou.jpg') }}" alt="photo de profil" style="height: 120px;">
                            {% endif %}
                            <strong>{{ babysitter.getHiddenName() }}</strong>
                            <p>Paris</p>
                        </div>
                        <div class="body">
                            <p>{{ babysitter.babysitter.category }}</p>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">

        var latlng = new google.maps.LatLng(48.8575162, 2.3426246);
        // paris : 48.8575162	2.3426246
        //objet contenant des propriétés avec des identificateurs prédéfinis dans Google Maps permettant
        //de définir des options d'affichage de notre carte
        var options = {
            center: latlng,
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        //constructeur de la carte qui prend en paramêtre le conteneur HTML
        //dans lequel la carte doit s'afficher et les options
        var map = new google.maps.Map(document.getElementById("map"), options);

        //Positionnement des nounou
        {% for entity in nounous %}
        {% if entity.user.latitude and entity.user.longitude %}
        var nounou_position{{ loop.index }} = new google.maps.LatLng({{ entity.user.latitude }},{{ entity.user.longitude }});
        var nounou_m{{ loop.index }} = new google.maps.Marker({
            position: nounou_position{{ loop.index }},
            map: map
        });
        var nounou_contentm{{ loop.index }} = '' +
                '<a href="{{ path('babysitter_show', {'id': entity.id}) }}">' +
                '   <div class="mini-profile" style="margin-left: 0;">' +
                '       <div class="header">' +
                {% if entity.avatar %}
                '           <img class="profile-picture" src="{{ asset('uploads/babysitters/' ~ entity.avatar) }}" alt="photo de profil de {{ entity.user.firstname }}" style="height: 120px;">' +
                {% else %}
                '           <img class="profile-picture" src="{{ asset('bundles/pnpn/images/illus/nounou.jpg') }}" alt="photo de profil" style="height: 120px;">' +
                {% endif %}
                '           <strong>{{ entity.user.getHiddenName() }}</strong>' +
                '           <p>Paris</p>' +
                '       </div>' +
                '       <div class="body">' +
                '           <p>{{ entity.category }}</p>' +
                '       </div>' +
                '   </div>' +
                '</a>';
        var nounou_info{{ loop.index }} = new google.maps.InfoWindow({
            content  : nounou_contentm{{ loop.index }},
            position : nounou_position{{ loop.index }}
        });
        google.maps.event.addListener(nounou_m{{ loop.index }}, 'click', function() {
            nounou_info{{ loop.index }}.open(map,nounou_m{{ loop.index }});
        });
        {% endif %}
        {% endfor %}

    </script>
    <script type="text/javascript">

        $(function() {
            $('.mini-profile').hover(
                    function() {
                        $(this).children(".header").css('background-color','#e84355');
                    }
                    , function() {
                        $(this).children(".header").css('background-color','#eeeeee');
                    });
        })

    </script>
{% endblock %}